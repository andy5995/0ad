# https://docs.travis-ci.com/user/customizing-the-build/
language: cpp

sudo: required

matrix:
  include:
    - os: linux
      compiler: gcc
      addons:
        apt:
          packages:
          - gcc-4.8
          - g++-4.8
      env: Tr_Compiler_Version="-4.8"
      dist: trusty
    - os: linux
      compiler: gcc
      addons:
        apt:
          sources:
          - ubuntu-toolchain-r-test
          packages:
          - gcc-6
          - g++-6
      env: Tr_Compiler_Version="-6"
      dist: trusty
    - os: linux
      compiler: gcc
      env: Compiler_Version="7"
      dist: trusty
    - os: linux
      compiler: gcc
      addons:
        apt:
          sources:
          - ubuntu-toolchain-r-test
          packages:
          - gcc-8
          - g++-8
      env: Tr_Compiler_Version="-8"
      dist: trusty
    - os: linux
      compiler: clang
      env: Compiler_Version="5"
      dist: trusty
#    - os: linux
#      compiler: clang
#      addons:
#        apt:
#          packages:
#          - clang-6.0
#      env: Tr_Compiler_Version="clang6.0"
#      dist: trusty
#    - os: osx
#      osx_image: xcode9.2
#      env: Tr_Xcode_Version="9.2"
    - os: osx
      osx_image: xcode9.3beta
      env: Tr_Xcode_Version="9.3beta"

before_install:
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew update; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew install enet libogg glew gloox libogg libsodium libvorbis libxml2 miniupnpc sdl2; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew outdated cmake || brew upgrade cmake; brew outdated pkgconfig || brew upgrade pkgconfig; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then ./.travis_before_install.sh; fi
script:
  - export CXX=$CXX$Tr_Compiler_Version
  - export CC=$CC$Tr_Compiler_Version
  - build/workspaces/update-workspaces.sh --with-system-nvtt
  - make -C build/workspaces/gcc
